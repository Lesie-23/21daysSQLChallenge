Day 10 – CASE Statements

Focus: Adding conditional logic in SQL to categorize and label data.

✅ Learnings:-

- CASE lets you apply if-else logic in SQL queries.
- Always use ELSE to handle unexpected values; otherwise, SQL returns NULL.
- CASE is an expression, so you can use it anywhere a column is allowed: SELECT, ORDER BY, or inside aggregates.
- SQL evaluates conditions from top to bottom. The first match wins, so order matters.
- All results in a CASE must have compatible data types.
- Useful for creating categories, labels, and derived columns, and for custom sorting in queries.

✅ Practice Questions:

-- 1. Categorise patients as 'High', 'Medium', or 'Low' satisfaction based on their scores.
select
patient_id,
name,
case 
   when satisfaction >= 95 then 'High'
   when satisfaction >= 75 then 'Medium'
   else 'Low'
end as satisfaction_scores
from patients;

-- 2.Label staff roles as 'Medical' or 'Support' based on role type.
select
staff_id,
staff_name,
role,
case 
   when role in('doctor' , 'nurse') then 'Medical'
   else 'Support'
end as staff_roles
from staff;


-- 3.Create age groups for patients (0-18, 19-40, 41-65, 65+).
select
patient_id,
name,
case 
  when age <= 18 then 'Pediatric/Teen'
  when  age<= 40 then 'Adults'
  when age <=65 then 'Middle Age'
   else 'Senior'
end as age_groups
from patients;



-- Day 10 Question: Create a service performance report showing service name, total patients admitted, and a performance category based on the following: 
-- 'Excellent' if avg satisfaction >= 85, 'Good' if >= 75, 'Fair' if >= 65, otherwise 'Needs Improvement'.
-- Order by average satisfaction descending.

SELECT
    service,
    ROUND(AVG(patient_satisfaction), 2) AS avg_satisfaction,
    sum(patients_admitted) as total_patients_admitted,
    CASE
        WHEN AVG(patient_satisfaction) >= 85 THEN 'Excellent'
        WHEN AVG(patient_satisfaction) >= 75 THEN 'Good'
        WHEN AVG(patient_satisfaction) >= 65 THEN 'Fair'
        ELSE 'Needs Improvement'
    END AS performance_category
FROM services_weekly
GROUP BY service
ORDER BY AVG(patient_satisfaction) DESC;




