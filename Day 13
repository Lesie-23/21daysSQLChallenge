Day 13 – INNER JOINs

Focus: Combining tables based on matching columns.

✅ Learnings:

- Returns only rows with matches in both tables.
- Use table aliases and qualify columns.
- JOIN = INNER JOIN.
- Chain multiple joins to connect more tables.
- Use WHERE after ON for extra filtering.

✅ Practice Questions:

-- 1.Join patients and staff based on their common service field (show patient and staff who work in same service).
select
p.patient_id,
p.name as patient_name,
p.service,
s.staff_id,
s.staff_name,
s.role
from patients as p
Inner Join staff as s
on p.service = s.service;

-- 2.Join services_weekly with staff to show weekly service data with staff information.
select
sw.week,
sw.service as weekly_service,
sw.patients_request,
sw.patients_refused,
sw.patients_admitted,
sw.patient_satisfaction ,
sw.staff_morale,
sw.event,
s.staff_id,
s.staff_name,
s.role
from services_weekly  as sw
Inner Join staff as s
on sw.service = s.service;

-- 3. Create a report showing patient information along with staff assigned to their service.
select
p.patient_id,
p.name,
p.age,
p.service,
s.staff_id,
s.staff_name
from patients as p
Inner Join staff as s
on p.service = s.service;

/* Day 13 Question:  Create a comprehensive report showing patient_id, patient name, age, service, and the total number of staff members available in their service. 
Only include patients from services that have more than 5 staff members. Order by number of staff descending, then by patient name.*/

SELECT
    p.patient_id,
    p.name AS patient_name,
    p.age AS patient_age,
    p.service,
    s.total_staff_members
FROM patients p
JOIN (
    SELECT service, COUNT(*) AS total_staff_members
    FROM staff
    GROUP BY service
    HAVING COUNT(*) > 5
) AS s
ON p.service = s.service
ORDER BY s.total_staff_members DESC, p.name;


