Day 9 – DATE & TIME Functions

Focus: Working with dates and times to extract insights, calculate durations, and prepare reports in SQL.

✅ Learnings:

- Date functions let you analyze time-based data effectively.
- CURDATE() returns the current date, current_timestamp() returns date + time.
- DATEDIFF(date1, date2) calculates the number of days between two dates.
- DATE_ADD(date, INTERVAL n DAY) / DATE_SUB(date, INTERVAL n DAY) adds or subtracts days, months, or years.
- EXTRACT(YEAR FROM date) / EXTRACT(MONTH FROM date) retrieves specific parts of a date.
- YEAR(date), MONTH(date), DAY(date) extract year, month, or day values directly.

✅ Practice Questions:

-- 1.Extract the year from all patient arrival dates.
select
patient_id,
extract(year from arrival_date) as arrived_year
from patients;

-- 2.Calculate the length of stay for each patient (departure_date - arrival_date).
select
patient_id,
name as patient_name,
datediff(departure_date,arrival_date) as length_of_stay
from patients;

-- 3.Find all patients who arrived in a specific month.
select
count(patient_id) as total_patients,
month(arrival_date) as month
from patients
group by month(arrival_date)
order by month(arrival_date) asc ;


-- Day 9 Question: Calculate the average length of stay (in days) for each service, showing only services where the average stay is more than 7 days.
--  Also show the count of patients and order by average stay descending.
select
service,
count(patient_id) as total_patients,
round(avg(datediff(departure_date,arrival_date)),2) as avg_stay_days
from patients
group by service
having avg(datediff(departure_date,arrival_date)) > 7
order by avg_stay_days desc;
