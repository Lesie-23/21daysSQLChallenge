Day 6 – GROUP BY

Focus: Summarizing data, aggregating results, and uncovering patterns by grouping rows.

✅ Learnings:

- GROUP BY divides rows into groups based on column values.	
- Aggregate functions (COUNT, SUM, AVG, MIN, MAX) summarize data per group.		
- Every non-aggregated column in SELECT must appear in GROUP BY.		
- Use WHERE to filter rows before grouping and HAVING to filter groups after aggregation.	
- Combine multiple columns to group data at finer granularity.		
- GROUP BY is essential to spot totals, trends, or top performers, turning raw rows into actionable insights.	
	
✅ Practice Questions:

-- 1. Count the number of patients by each service.
select
service,
count(*) as total_patients
from patients
group by service;

-- 2. Calculate the average age of patients grouped by service.
select
service,
round(avg(age),2) as average_age
from patients
group by service;

-- 3. Find the total number of staff members per role.
select
role,
count(*) as total_staff
from staff
group by role;

-- Day 6  Question: For each hospital service, calculate the total number of patients admitted, total patients refused, and the admission rate
 -- (percentage of requests that were admitted). Order by admission rate descending.
SELECT
    service,
    SUM(patients_admitted) AS total_patients_admitted,
    SUM(patients_refused) AS total_patients_refused,
    ROUND(SUM(patients_admitted) * 100/SUM(patients_request),2) AS admission_rate
FROM services_weekly
GROUP BY service
ORDER BY admission_rate DESC;
